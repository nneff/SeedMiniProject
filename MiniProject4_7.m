% The K and sigma values from the previous section were used in the
% Simulink model to perform a closed loop step response experiment. A block
% diagram was made with a PI controller before the transfer function block,
% and it was tuned to have a rise time < 1s and less than 12% overshoot.
% This gave proportional(Kp) and integral(Ki) values that were used in the
% Arduino program to implement the PI controller.

clear
K = 1.50;
sig = 7.142;

open_system('PIcontrollerStepResponse');
out = sim('PIcontrollerStepResponse');

%EXPERIMENTAL DATA
% Position and time data obtained from the Arduino closed loop step
% response experiment
time = [1000 1004 1009 1014 1019 1024 1029 1034 1039 1044 1049 1054 1059 1064 1069 1074 1079 1084 1089 1094 1099 1104 1110 1115 1120 1125 1130 1135 1140 1145 1150 1155 1160 1165 1170 1175 1180 1185 1190 1195 1200 1205 1210 1215 1220 1225 1230 1235 1240 1245 1250 1255 1260 1265 1270 1275 1280 1285 1290 1295 1300 1305 1310 1315 1320 1325 1330 1335 1340 1345 1350 1355 1360 1366 1371 1376 1381 1386 1391 1396 1401 1406 1411 1416 1421 1426 1431 1436 1441 1446 1451 1456 1461 1466 1471 1476 1481 1486 1491 1496 1501 1506 1511 1516 1521 1526 1531 1536 1541 1546 1551 1556 1561 1566 1571 1576 1581 1586 1591 1596 1601 1606 1611 1616 1622 1627 1632 1637 1642 1647 1652 1657 1662 1667 1672 1677 1682 1687 1692 1697 1702 1707 1712 1717 1722 1727 1732 1737 1742 1747 1752 1757 1762 1767 1772 1777 1782 1787 1792 1797 1802 1807 1812 1817 1822 1827 1832 1837 1842 1847 1852 1857 1862 1867 1872 1878 1883 1888 1893 1898 1903 1908 1913 1918 1923 1928 1933 1938 1943 1948 1953 1958 1963 1968 1973 1978 1983 1988 1993 1998 2003 2008 2013 2018 2023 2028 2033 2038 2043 2048 2053 2058 2063 2068 2073 2078 2083 2088 2093 2098 2103 2108 2113 2118 2123 2128 2134 2139 2144 2149 2154 2159 2164 2169 2174 2179 2184 2189 2194 2199 2204 2209 2214 2219 2224 2229 2234 2239 2244 2249 2254 2259 2264 2269 2274 2279 2284 2289 2294 2299 2304 2309 2314 2319 2324 2329 2334 2339 2344 2349 2354 2359 2364 2369 2374 2379 2384 2390 2395 2400 2405 2410 2415 2420 2425 2430 2435 2440 2445 2450 2455 2460 2465 2470 2475 2480 2485 2490 2495 2500 2505 2510 2515 2520 2525 2530 2535 2540 2545 2550 2555 2560 2565 2570 2575 2580 2585 2590 2595 2600 2605 2610 2615 2620 2625 2630 2635 2640 2646 2651 2656 2661 2666 2671 2676 2681 2686 2691 2696 2701 2706 2711 2716 2721 2726 2731 2736 2741 2746 2751 2756 2761 2766 2771 2776 2781 2786 2791 2796 2801 2806 2811 2816 2821 2826 2831 2836 2841 2846 2851 2856 2861 2866 2871 2876 2881 2886 2891 2896 2902 2907 2912 2917 2922 2927 2932 2937 2942 2947 2952 2957 2962 2967 2972 2977 2982 2987 2992 2997 3002 3007 3012 3017 3022 3027 3032 3037 3042 3047 3052 3057 3062 3067 3072 3077 3082 3087 3092 3097 3102 3107 3112 3117 3122 3127 3132 3137 3142 3147 3152 3158 3163 3168 3173 3178 3183 3188 3193 3198 3203 3208 3213 3218 3223 3228 3233 3238 3243 3248 3253 3258 3263 3268 3273 3278 3283 3288 3293 3298 3303 3308 3313 3318 3323 3328 3333 3338 3343 3348 3353 3358 3363 3368 3373 3378 3383 3388 3393 3398 3403 3408 3414 3419 3424 3429 3434 3439 3444 3449 3454 3459 3464 3469 3474 3479 3484 3489 3494 3499 3504 3509 3514 3519 3524 3529 3534 3539 3544 3549 3554 3559 3564 3569 3574 3579 3584 3589 3594 3599 3604 3609 3614 3619 3624 3629 3634 3639 3644 3649 3654 3659 3664 3670 3675 3680 3685 3690 3695 3700 3705 3710 3715 3720 3725 3730 3735 3740 3745 3750 3755 3760 3765 3770 3775 3780 3785 3790 3795 3800 3805 3810 3815 3820 3825 3830 3835 3840 3845 3850 3855 3860 3865 3870 3875 3880 3885 3890 3895 3900 3905 3910 3915 3920 3926 3931 3936 3941 3946 3951 3956 3961 3966 3971 3976 3981 3986 3991 3996 4001 4006 4011 4016 4021 4026 4031 4036 4041 4046 4051 4056 4061 4066 4071 4076 4081 4086 4091 4096 4101 4106 4111 4116 4121 4126 4131 4136 4141 4146 4151 4156 4161 4166 4171 4176 4182 4187 4192 4197 4202 4207 4212 4217 4222 4227 4232 4237 4242 4247 4252 4257 4262 4267 4272 4277 4282 4287 4292 4297 4302 4307 4312 4317 4322 4327 4332 4337 4342 4347 4352 4357 4362 4367 4372 4377 4382 4387 4392 4397 4402 4407 4412 4417 4422 4427 4432 4438 4443 4448 4453 4458 4463 4468 4473 4478 4483 4488 4493 4498 4503 4508 4513 4518 4523 4528 4533 4538 4543 4548 4553 4558 4563 4568 4573 4578 4583 4588 4593 4598 4603 4608 4613 4618 4623 4628 4633 4638 4643 4648 4653 4658 4663 4668 4673 4678 4683 4688 4694 4699 4704 4709 4714 4719 4724 4729 4734 4739 4744 4749 4754 4759 4764 4769 4774 4779 4784 4789 4794 4799 4804 4809 4814 4819 4824 4829 4834 4839 4844 4849 4854 4859 4864 4869 4874 4879 4884 4889 4894 4899 4904 4909 4914 4919 4924 4929 4934 4939 4944 4950 4955 4960 4965 4970 4975 4980 4985 4990 4995 5000 5005 5010 5015 5020 5025 5030 5035 5040 5045 5050 5055 5060 5065 5070 5075 5080 5085 5090 5095 5100 5105 5110 5115 5120 5125 5130 5135 5140 5145 5150 5155 5160 5165 5170 5175 5180 5185 5190 5195 5200 5206 5211 5216 5221 5226 5231 5236 5241 5246 5251 5256 5261 5266 5271 5276 5281 5286 5291 5296 5301 5306 5311 5316 5321 5326 5331 5336 5341 5346 5351 5356 5361 5366 5371 5376 5381 5386 5391 5396 5401 5406 5411 5416 5421 5426 5431 5436 5441 5446 5451 5456 5462 5467 5472 5477 5482 5487 5492 5497 5502 5507 5512 5517 5522 5527 5532 5537 5542 5547 5552 5557 5562 5567 5572 5577 5582 5587 5592 5597 5602 5607 5612 5617 5622 5627 5632 5637 5642 5647 5652 5657 5662 5667 5672 5677 5682 5687 5692 5697 5702 5707 5712 5718 5723 5728 5733 5738 5743 5748 5753 5758 5763 5768 5773 5778 5783 5788 5793 5798 5803 5808 5813 5818 5823 5828 5833 5838 5843 5848 5853 5858 5863 5868 5873 5878 5883 5888 5893 5898 5903 5908 5913 5918 5923 5928 5933 5938 5943 5948 5953 5958 5963 5968 5974 5979 5984 5989 5994 5999 6004 6009 6014 6019 6024 6029 6034 6039 6044 6049 6054 6059 6064 6069 6074 6079 6084 6089 6094 6099 6104 6109 6114 6119 6124 6129 6134 6139 6144 6149 6154 6159 6164 6169 6174 6179 6184 6189 6194 6199 6204 6209 6214 6219 6224 6230 6235 6240 6245 6250 6255 6260 6265 6270 6275 6280 6285 6290 6295 6300 6305 6310 6315 6320 6325 6330 6335 6340 6345 6350 6355 6360 6365 6370 6375 6380 6385 6390 6395 6400 6405 6410 6415 6420 6425 6430 6435 6440 6445 6450 6455 6460 6465 6470 6475 6480 6486 6491 6496 6501 6506 6511 6516 6521 6526 6531 6536 6541 6546 6551 6556 6561 6566 6571 6576 6581 6586 6591 6596 6601 6606 6611 6616 6621 6626 6631 6636 6641 6646 6651 6656 6661 6666 6671 6676 6681 6686 6691 6696 6701 6706 6711 6716 6721 6726 6731 6736 6742 6747 6752 6757 6762 6767 6772 6777 6782 6787 6792 6797 6802 6807 6812 6817 6822 6827 6832 6837 6842 6847 6852 6857 6862 6867 6872 6877 6882 6887 6892 6897 6902 6907 6912 6917 6922 6927 6932 6937 6942 6947 6952 6957 6962 6967 6972 6977 6982 6987 6992 6998 7003 7008 7013 7018 7023 7028 7033 7038 7043 7048 7053 7058 7063 7068 7073 7078 7083 7088 7093 7098 7103 7108 7113 7118 7123 7128 7133 7138 7143 7148 7153 7158 7163 7168 7173 7178 7183 7188 7193 7198 7203 7208 7213 7218 7223 7228 7233 7238 7243 7248 7254 7259 7264 7269 7274 7279 7284 7289 7294 7299 7304 7309 7314 7319 7324 7329 7334 7339 7344 7349 7354 7359 7364 7369 7374 7379 7384 7389 7394 7399 7404 7409 7414 7419 7424 7429 7434 7439 7444 7449 7454 7459 7464 7469 7474 7479 7484 7489 7494 7499 7504 7510 7515 7520 7525 7530 7535 7540 7545 7550 7555 7560 7565 7570 7575 7580 7585 7590 7595 7600 7605 7610 7615 7620 7625 7630 7635 7640 7645 7650 7655 7660 7665 7670 7675 7680 7685 7690 7695 7700 7705 7710 7715 7720 7725 7730 7735 7740 7745 7750 7755 7760 7766 7771 7776 7781 7786 7791 7796 7801 7806 7811 7816 7821 7826 7831 7836 7841 7846 7851 7856 7861 7866 7871 7876 7881 7886 7891 7896 7901 7906 7911 7916 7921 7926 7931 7936 7941 7946 7951 7956 7961 7966 7971 7976 7981 7986 7991 7996 8001 8006 8011 8016 8022 8027 8032 8037 8042 8047 8052 8057 8062 8067 8072 8077 8082 8087 8092 8097 8102 8107 8112 8117 8122 8127 8132 8137 8142 8147 8152 8157 8162 8167 8172 8177 8182 8187 8192 8197 8202 8207 8212 8217 8222 8227 8232 8237 8242 8247 8252 8257 8262 8267 8272 8278 8283 8288 8293 8298 8303 8308 8313 8318 8323 8328 8333 8338 8343 8348 8353 8358 8363 8368 8373 8378 8383 8388 8393 8398 8403 8408 8413 8418 8423 8428 8433 8438 8443 8448 8453 8458 8463 8468 8473 8478 8483 8488 8493 8498 8503 8508 8513 8518 8523 8528 8534 8539 8544 8549 8554 8559 8564 8569 8574 8579 8584 8589 8594 8599 8604 8609 8614 8619 8624 8629 8634 8639 8644 8649 8654 8659 8664 8669 8674 8679 8684 8689 8694 8699 8704 8709 8714 8719 8724 8729 8734 8739 8744 8749 8754 8759 8764 8769 8774 8779 8784 8790 8795 8800 8805 8810 8815 8820 8825 8830 8835 8840 8845 8850 8855 8860 8865 8870 8875 8880 8885 8890 8895 8900 8905 8910 8915 8920 8925 8930 8935 8940 8945 8950 8955 8960 8965 8970 8975 8980 8985 8990 8995 9000 9005 9010 9015 9020 9025 9030 9035 9040 9046 9051 9056 9061 9066 9071 9076 9081 9086 9091 9096 9101 9106 9111 9116 9121 9126 9131 9136 9141 9146 9151 9156 9161 9166 9171 9176 9181 9186 9191 9196 9201 9206 9211 9216 9221 9226 9231 9236 9241 9246 9251 9256 9261 9266 9271 9276 9281 9286 9291 9296 9302 9307 9312 9317 9322 9327 9332 9337 9342 9347 9352 9357 9362 9367 9372 9377 9382 9387 9392 9397 9402 9407 9412 9417 9422 9427 9432 9437 9442 9447 9452 9457 9462 9467 9472 9477 9482 9487 9492 9497 9502 9507 9512 9517 9522 9527 9532 9537 9542 9547 9552 9558 9563 9568 9573 9578 9583 9588 9593 9598 9603 9608 9613 9618 9623 9628 9633 9638 9643 9648 9653 9658 9663 9668 9673 9678 9683 9688 9693 9698 9703 9708 9713 9718 9723 9728 9733 9738 9743 9748 9753 9758 9763 9768 9773 9778 9783 9788 9793 9798 9803 9808 9814 9819 9824 9829 9834 9839 9844 9849 9854 9859 9864 9869 9874 9879 9884 9889 9894 9899 9904 9909 9914 9919 9924 9929 9934 9939 9944 9949 9954 9959 9964 9969 9974 9979 9984 9989 9994 9999 10004 10009 10014 10019 10024 10029 10034 10039 10044 10049 10054 10059 10064 10070 10075 10080 10085 10090 10095 10100 10105 10110 10115 10120 10125 10130 10135 10140 10145 10150 10155 10160 10165 10170 10175 10180 10185 10190 10195 10200 10205 10210 10215 10220 10225 10230 10235 10240 10245 10250 10255 10260 10265 10270 10275 10280 10285 10290 10295 10300 10305 10310 10315 10320 10326 10331 10336 10341 10346 10351 10356 10361 10366 10371 10376 10381 10386 10391 10396 10401 10406 10411 10416 10421 10426 10431 10436 10441 10446 10451 10456 10461 10466 10471 10476 10481 10486 10491 10496 10501 10506 10511 10516 10521 10526 10531 10536 10541 10546 10551 10556 10561 10566 10571 10576 10582 10587 10592 10597 10602 10607 10612 10617 10622 10627 10632 10637 10642 10647 10652 10657 10662 10667 10672 10677 10682 10687 10692 10697 10702 10707 10712 10717 10722 10727 10732 10737 10742 10747 10752 10757 10762 10767 10772 10777 10782 10787 10792 10797 10802 10807 10812 10817 10822 10827 10832 10838 10843 10848 10853 10858 10863 10868 10873 10878 10883 10888 10893 10898 10903 10908 10913 10918 10923 10928 10933 10938 10943 10948 10953 10958 10963 10968 10973 10978 10983 10988 10993 10998];
time = (time./1000);
angle = [0.00 0.00 0.00 0.00 0.00 0.01 0.01 0.02 0.02 0.02 0.03 0.04 0.04 0.05 0.05 0.06 0.07 0.07 0.08 0.09 0.09 0.10 0.11 0.12 0.12 0.13 0.14 0.15 0.15 0.16 0.17 0.18 0.18 0.19 0.20 0.21 0.22 0.22 0.23 0.24 0.25 0.26 0.26 0.27 0.28 0.29 0.29 0.30 0.31 0.32 0.33 0.33 0.34 0.35 0.36 0.37 0.38 0.38 0.39 0.40 0.41 0.42 0.42 0.43 0.44 0.45 0.46 0.47 0.48 0.48 0.49 0.50 0.51 0.51 0.52 0.53 0.54 0.55 0.55 0.56 0.57 0.58 0.59 0.60 0.60 0.61 0.62 0.63 0.64 0.64 0.65 0.66 0.67 0.68 0.68 0.69 0.70 0.71 0.71 0.72 0.73 0.74 0.75 0.75 0.76 0.77 0.78 0.79 0.80 0.81 0.81 0.82 0.83 0.84 0.84 0.85 0.86 0.87 0.88 0.88 0.89 0.90 0.91 0.91 0.92 0.93 0.94 0.95 0.95 0.96 0.97 0.98 0.99 0.99 1.00 1.01 1.01 1.01 1.01 1.01 1.01 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02 1.02];

figure(1)
hold on
plot(out.position)
plot(time,angle,'Color','r')
xlim([0 10])
xlabel('time'); ylabel('Angular Position (rad)');
legend('Simulated','Experimental','location','southeast');
hold off

% As seen from the resulting plot, the addition of a PI controller provided
% a simulated closed loop step response that very closely matches the
% experimental closed loop step response. The tuned values of Kp and Ki
% were found using the PID tuner app and resulted in values of Kp = 1.99
% and Ki = 0.097. These values initially did not provide the best response,
% so they were slightly altered and tested in the Arduino program until the
% performance of the motor's position control was as good as possible.